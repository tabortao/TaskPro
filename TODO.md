# Task: 修复任务详情页面和优化任务卡片

## Plan
- [x] 1. 修复数据库关系错误
  - [x] 1.1 检查 comments 表的外键关系
  - [x] 1.2 修改查询语句（分两步查询）
  - [x] 1.3 测试数据库查询
- [x] 2. 优化任务卡片和详情页面
  - [x] 2.1 移除任务卡片右上角的菜单栏
  - [x] 2.2 在任务详情页面添加菜单栏
  - [x] 2.3 实现置顶、编辑、收藏、删除功能
- [x] 3. 测试功能
  - [x] 3.1 测试数据库查询
  - [x] 3.2 运行 lint 检查
- [x] 4. 运行 lint 检查

## Notes
- ✅ 修复 getCommentsByTaskId 查询（分两步查询避免关系错误）
- ✅ 移除任务卡片右上角的菜单栏
- ✅ 在任务详情页面添加右上角菜单按钮
- ✅ 菜单包括：置顶、编辑、收藏、删除
- ✅ 测试数据库查询正常工作
- ✅ 所有代码通过 lint 检查（40 个文件）

## 问题原因
1. Supabase 无法找到 comments 和 profiles 的关系
   - comments.user_id 引用的是 auth.users，而不是 profiles
   - 使用 `profiles!user_id` 语法会报错

## 修复方案
1. 修改 getCommentsByTaskId 查询方式：
   - 第一步：查询所有评论
   - 第二步：查询所有评论者的 profiles 信息
   - 第三步：手动组合数据
2. 简化 TaskItem 组件，移除菜单相关代码
3. 在任务详情页面添加右上角菜单按钮

## 待用户测试
- 请测试任务详情页面是否能正常加载
- 请测试是否能成功创建评论
- 请测试右上角菜单是否正常显示
- 请测试置顶、收藏、删除功能是否正常
